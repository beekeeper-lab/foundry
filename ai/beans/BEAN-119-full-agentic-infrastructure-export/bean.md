# BEAN-119: Full Agentic Infrastructure Export

| Field | Value |
|-------|-------|
| **Bean ID** | BEAN-119 |
| **Status** | Done |
| **Priority** | High |
| **Created** | 2026-02-14 |
| **Started** | 2026-02-14 13:35 |
| **Completed** | 2026-02-14 13:47 |
| **Duration** | 12m |
| **Owner** | team-lead |
| **Category** | App |

## Problem Statement

When Foundry generates a new project, it produces agent files, a compiled CLAUDE.md, and some library-sourced commands/hooks/skills. However, it does not include the full agentic team infrastructure — the 12 skills (`/long-run`, `/deploy`, `/backlog-refinement`, `/merge-bean`, etc.), 14 commands, bean workflow process docs, bean template, backlog index, telemetry hooks, or safety permission configs. The generated project cannot autonomously manage a backlog, decompose work, run parallel workers, or deploy — capabilities that make the Foundry team effective. Every generated project should be born as a fully autonomous agentic team.

## Goal

Every project generated by Foundry includes the complete agentic infrastructure: all skills, commands, process docs, bean workflow, and safety configs — so a Claude agent can immediately run `/long-run` or `/deploy` in the new project without any manual setup.

## Scope

### In Scope
- Copy 12 agentic skills into `ai-team-library/claude/skills/` (with subdirectory structure)
- Copy 14 command files into `ai-team-library/claude/commands/`
- Copy telemetry-stamp hook into the library
- Add bean workflow docs to library: `bean-workflow.md`, `_bean-template.md`, empty `_index.md`
- Update asset copier to recursively copy skill subdirectories (each skill is a folder with `SKILL.md`)
- Update scaffold to create `ai/beans/`, `ai/outputs/`, `ai/context/` directories
- Copy `.claude/settings.json` (hooks config) and `.claude/settings.local.json` (safety permissions) — no secrets
- Sanitize Foundry-specific references (project name, paths) in copied files where needed
- Ensure `.mcp.json` (contains API keys) is never copied

### Out of Scope
- Changing the compiled CLAUDE.md format (already works)
- Agent file generation (already works via agent_writer)
- MCP server config generation (already works via mcp_writer)
- Making skills project-aware at runtime (they use relative paths which work anywhere)
- Trello integration setup in generated projects (project-specific)

## Acceptance Criteria

- [x] All 12 skills exist in `ai-team-library/claude/skills/` with SKILL.md files
- [x] All 14 commands exist in `ai-team-library/claude/commands/`
- [x] Asset copier recursively copies skill subdirectories (not just top-level .md files)
- [x] Generated project has `ai/beans/_index.md` and `ai/beans/_bean-template.md`
- [x] Generated project has `ai/context/bean-workflow.md`
- [x] Generated project has `.claude/settings.json` with hooks config
- [x] Generated project has `.claude/settings.local.json` with safety permissions
- [x] No API keys, tokens, or secrets in any copied files
- [x] `.mcp.json` is not copied to generated projects
- [x] A freshly generated project contains `/long-run`, `/deploy`, `/backlog-refinement` skills
- [x] All tests pass (`uv run pytest`)
- [x] Lint clean (`uv run ruff check foundry_app/`)

## Tasks

| # | Task | Owner | Depends On | Status |
|---|------|-------|------------|--------|
| 1 | Copy 12 agentic skills to library | developer | — | Done |
| 2 | Copy 14 command files to library | developer | — | Done |
| 3 | Add process docs (bean-workflow, template, index) | developer | — | Done |
| 4 | Add settings configs and telemetry hook to library | developer | — | Done |
| 5 | Update asset copier for recursive subdirectory copying | developer | 1 | Done |
| 6 | Sanitize Foundry-specific references in library files | developer | 1,2 | Done |
| 7 | Run tests, lint, and verify generated project | tech-qa | 5,6 | Done |

## Notes

- The 12 skills use relative paths (`ai/beans/_index.md`, etc.) that work in any project
- Skills reference generic personas (team-lead, developer, tech-qa) — these match the generated agent files
- `.mcp.json` has Trello API keys and is already gitignored — must never be copied
- `.claude/settings.local.json` has permission rules but no secrets — safe to copy
- The asset copier currently only copies top-level `.md` files from each directory — needs to handle subdirectories for skills (each skill is a `<name>/SKILL.md` folder)

## Telemetry

| # | Task | Owner | Duration | Tokens In | Tokens Out |
|---|------|-------|----------|-----------|------------|
| 1 |      |       |          |           |            |

| Metric | Value |
|--------|-------|
| **Total Tasks** | 1 |
| **Total Duration** | 12m |
| **Total Tokens In** | — |
| **Total Tokens Out** | — |
