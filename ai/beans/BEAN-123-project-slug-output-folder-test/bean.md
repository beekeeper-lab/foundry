# BEAN-123: Project Slug Output Folder Test

| Field | Value |
|-------|-------|
| **Bean ID** | BEAN-123 |
| **Status** | Done |
| **Priority** | Medium |
| **Created** | 2026-02-14 |
| **Started** | 2026-02-14 15:07 |
| **Completed** | 2026-02-14 15:10 |
| **Duration** | 3m |
| **Owner** | team-lead |
| **Category** | App |

## Problem Statement

The generation pipeline derives the output subfolder name from the project slug (which is auto-generated from the project name via `_slugify()`), but no test explicitly verifies that the generated project's output directory basename matches the expected slug. BEAN-117's E2E test uses a fixed example YAML and checks structural layout — it doesn't test the slug→folder mapping.

## Goal

Add a test that creates a CompositionSpec with a known project name, runs the generation pipeline, and asserts that the output subfolder basename equals the expected slug derived from that name.

## Scope

### In Scope
- One test in `tests/test_generator.py` (or a new `test_slug_folder.py`) that:
  - Creates a CompositionSpec with a project name containing spaces/mixed case (e.g., "My Cool Project")
  - Runs generation to a `tmp_path`
  - Asserts `output_dir.name == "my-cool-project"`

### Out of Scope
- Testing the `_slugify()` function with parametrized edge cases
- GUI/widget testing of the slug field
- Testing `output_folder` override (when user explicitly sets a custom folder name)

## Acceptance Criteria

- [ ] Test sets a project name and runs generation
- [ ] Test asserts the output directory basename matches the expected slug
- [ ] All tests pass (`uv run pytest`)
- [ ] Lint clean (`uv run ruff check foundry_app/`)

## Tasks

| # | Task | Owner | Depends On | Status |
|---|------|-------|------------|--------|
| 1 | Write slug output folder test | developer | — | Done |

> Tasks are populated by the Team Lead during decomposition.
> Task files go in `tasks/` subdirectory.

## Notes

- The slug is generated by `_slugify()` in `foundry_app/ui/screens/builder/wizard_pages/project_page.py`, but the model-level field is `ProjectIdentity.slug` validated with pattern `^[a-z0-9][a-z0-9-]*$`
- `generator.py` uses `composition.project.resolved_output_folder` which returns `self.output_folder or self.slug`
- Existing E2E pattern in `TestEndToEnd` class (test_generator.py:991) can be used as a reference

## Trello

| Field | Value |
|-------|-------|
| **Source** | Manual |

## Telemetry

| # | Task | Owner | Duration | Tokens In | Tokens Out |
|---|------|-------|----------|-----------|------------|
| 1 | Write slug output folder test | developer | < 1m | 1,811 | 31,127 |

| Metric | Value |
|--------|-------|
| **Total Tasks** | 1 |
| **Total Duration** | < 1m |
| **Total Tokens In** | 1,811 |
| **Total Tokens Out** | 31,127 |
